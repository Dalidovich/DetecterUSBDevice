# DUSBD - Детектор и блокировщик USB-устройств

## Описание проекта
DUSBD (Detect USB Device) - это Windows-сервис для мониторинга подключения USB-устройств и их блокировки по заданным параметрам VID (Vendor ID) и PID (Product ID). Сервис ведет лог всех подключений и автоматически отключает запрещенные устройства.

## Функциональные возможности
- Мониторинг подключения USB-устройств в реальном времени
- Блокировка устройств по VID/PID с помощью PowerShell
- Логирование всех событий подключения в файл `C:\DUSBDLog.txt`
- Поддержка блокировки устройств при их повторном подключении
- Возможность запуска с параметрами VID/PID для блокировки

## Установка
1. Скомпилируйте проект в Visual Studio
2. Установите сервис с помощью утилиты `installutil.exe`:
3. Для установки с параметрами блокировки:   
   installutil.exe /i /vid=XXXX /pid=XXXX DetecterUSBDevice.exe где XXXX - 4-значные VID и PID устройства

## Настройка
Параметры блокируемых устройств можно задать:
- При установке через аргументы командной строки
- Путем изменения аргументов запуска сервиса в свойствах службы Windows

## Использование
После установки сервис запускается автоматически. Все события записываются в лог-файл `C:\DUSBDLog.txt`.

## Удаление
Для удаления сервиса выполните: installutil.exe /u DetecterUSBDevice.exe